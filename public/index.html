<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Better Tent</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="stylesheet" href="/style.css" />
  </head>

  <body>
    <div class="app">
      <header class="topbar">
        <div class="brand">
          <div class="brandRow">
            <svg class="brandLogo" viewBox="0 0 64 64" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
              <rect width="64" height="64" rx="14" fill="#19c51e"/>
              <path d="M8 52 L32 12 L56 52 Z" fill="none" stroke="#ffffff" stroke-width="5" stroke-linejoin="round"/>
              <path d="M32 12 L32 52" fill="none" stroke="#ffffff" stroke-width="4" stroke-linecap="round"/>
              <path d="M22 52 L32 34 L42 52" fill="none" stroke="#ffffff" stroke-width="4" stroke-linejoin="round"/>
            </svg>
            <div class="title">Better Tent</div>
          </div>
          <div class="subtitle">
            A better way to play <a class="sourceLink" href="https://www.puzzle-tents.com" target="_blank" rel="noopener">puzzle-tents.com</a>
            &nbsp;Â·&nbsp; Enter an ID to load a specific puzzle, or hit Random for a new one
          </div>
        </div>

        <div class="topControls">
          <div class="loadControls">
            <label class="field">
              <span>Puzzle ID</span>
              <input id="pid" placeholder="e.g. 6008187" />
            </label>

            <label class="field">
              <span>Board</span>
              <select id="size">
                <option value="0">6Ã—6 Easy</option>
                <option value="1">6Ã—6 Hard</option>
                <option value="2">8Ã—8 Easy</option>
                <option value="3">8Ã—8 Hard</option>
                <option value="4">10Ã—10 Easy</option>
                <option value="5">10Ã—10 Hard</option>
                <option value="6">15Ã—15 Easy</option>
                <option value="7">15Ã—15 Hard</option>
              </select>
            </label>

            <button id="load" type="button">Load</button>
            <button id="random" type="button" title="Load a random puzzle of the selected size">Random</button>
          </div>

          <div class="toggles">
            <button id="hintBtn" class="ghost iconBtn" type="button" title="Hint" aria-label="Hint">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 1 4 12.7V17H8v-2.3A7 7 0 0 1 12 2z"/></svg>
            </button>
            <button id="solveBtn" class="ghost iconBtn" type="button" title="Solve" aria-label="Solve">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 4V2"/><path d="M15 16v-2"/><path d="M8 9h2"/><path d="M20 9h2"/><path d="M17.8 11.8 19 13"/><path d="M15 9h0"/><path d="M17.8 6.2 19 5"/><path d="m3 21 9-9"/><path d="M12.2 6.2 11 5"/></svg>
            </button>

            <button id="undo" class="ghost iconBtn" type="button" title="Undo (Ctrl/Cmd+Z)" aria-label="Undo">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg>
            </button>
            <button id="redo" class="ghost iconBtn" type="button" title="Redo (Ctrl/Cmd+Y)" aria-label="Redo">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 1 1-2.13-9.36L23 10"/></svg>
            </button>

            <button id="autoGrass" class="ghost iconBtn" type="button" title="Auto grass" aria-label="Auto grass">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 20h10"/><path d="M10 20c5.5-2.5 .8-6.4 3-10"/><path d="M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z"/><path d="M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z"/></svg>
            </button>

            <button id="coords" class="ghost iconBtn" type="button" title="Coordinates" aria-label="Coordinates">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="9" x2="20" y2="9"/><line x1="4" y1="15" x2="20" y2="15"/><line x1="9" y1="4" x2="9" y2="20"/><line x1="15" y1="4" x2="15" y2="20"/></svg>
            </button>

            <button id="themeBtn" class="ghost iconBtn themeToggle" type="button" title="Toggle theme" aria-label="Toggle theme">
              <svg class="themeIcon moonIcon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
              <svg class="themeIcon sunIcon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
            </button>
          </div>
        </div>
      </header>

      <section class="statusbar">
        <div id="status" class="status">Ready.</div>

        <!-- Legend + Customize -->
        <div class="legend legendUpgraded">
          <div class="legendItem">
            <span class="legendPreview tile" id="legendTree" aria-label="Tree"></span>
            <span class="legendLabel">TREE</span>
          </div>
          <div class="legendItem">
            <span class="legendPreview tile" id="legendTent" aria-label="Tent"></span>
            <span class="legendLabel">TENT</span>
          </div>
          <div class="legendItem">
            <span class="legendPreview tile" id="legendGrass" aria-label="Grass"></span>
            <span class="legendLabel">GRASS</span>
          </div>

          <button id="customize" class="ghost" type="button" title="Customize colors">
            Customize
          </button>
        </div>
      </section>

      <!-- Palette editor popover -->
      <div id="palettePopover" class="popover" style="display:none" role="dialog" aria-label="Palette">
        <div class="popoverArrow"></div>

        <section id="palette" class="palette">
          <div class="paletteHeader">
            <div class="paletteTitle">Palette</div>
            <button id="paletteClose" class="ghost" type="button" aria-label="Close palette">Close</button>
          </div>

          <div class="paletteBody">
            <div class="paletteGrid">
              <button class="paletteCard" data-target="tree" id="cardTree" type="button">
                <div class="paletteCell tile" id="paletteTree"></div>
                <div class="paletteLabel">TREE</div>
              </button>

              <button class="paletteCard" data-target="tent" id="cardTent" type="button">
                <div class="paletteCell tile" id="paletteTent"></div>
                <div class="paletteLabel">TENT</div>
              </button>

              <button class="paletteCard" data-target="grass" id="cardGrass" type="button">
                <div class="paletteCell tile" id="paletteGrass"></div>
                <div class="paletteLabel">GRASS</div>
              </button>
            </div>

            <div class="pickerPanel" id="pickerPanel">
              <div class="pickerRow" id="rowTreeCanopy">
                <label for="pickTreeCanopy">Canopy</label>
                <input type="color" id="pickTreeCanopy" />
              </div>

              <div class="pickerRow" id="rowTreeTrunk">
                <label for="pickTreeTrunk">Trunk</label>
                <input type="color" id="pickTreeTrunk" />
              </div>

              <div class="pickerRow" id="rowSpriteStroke">
                <label for="pickSpriteStroke">Outline</label>
                <input type="color" id="pickSpriteStroke" />
              </div>

              <div class="pickerRow" id="rowTentStroke">
                <label for="pickTentStroke">Tent</label>
                <input type="color" id="pickTentStroke" />
              </div>

              <div class="pickerRow" id="rowTile">
                <label for="pickTile">Tile/Grass</label>
                <input type="color" id="pickTile" />
                <div class="pickerHint">Grass is kept light automatically.</div>
              </div>

              <div class="pickerFooter">
                <button id="resetPalette" class="ghost" type="button">Reset</button>
                <div class="pickerHint rightHint">Saved automatically.</div>
              </div>
            </div>
          </div>
        </section>
      </div>

      <main class="stage">
        <div id="mount"></div>
      </main>
    </div>

    <!-- Celebration overlay -->
    <div id="celebrate" class="celebrate" style="display:none" aria-live="polite">
      <canvas id="confetti"></canvas>
      <div class="celebrateCard">
        <div class="celebrateTitle">CONGRATULATIONS ðŸŽ‰</div>
        <div class="celebrateText">You solved it.</div>
        <button id="celebrateClose" class="ghost" type="button">Nice</button>
      </div>
    </div>

    <!-- Solver attaches window.TentsSolver -->
    <script src="/solver.js"></script>

    <!-- Modular app entry -->
    <script type="module" src="/js/main.js"></script>
  </body>
</html>
